<div class="single-card">
    <div class="page-heading">
        <h1 class="container">{{scheda.nome|capitalize:all}} {{scheda.cognome|capitalize:all}}</h1>
    </div>
    <div ng-show="spinner" class="PT-dialog-msg">
        <p>
            <span class="glyphicon glyphicon-refresh spinning"></span> Recupero la scheda...
        </p>
    </div>

    <div ng-show="errors" class="PT-dialog-msg alert alert-danger" role="alert">
        <p>
            <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
            <span class="sr-only">Error:</span>
            Errore durante il recupero della scheda, riprova più tardi.
        </p>
    </div>

    <div ng-show="scheda">
        <!-- <a ng-show="scheda.indice_completezza > 2" href="#/campagna"
           style="position: absolute; top: 0px; right: 0px; border: 0; z-index:1000">
            <img alt="Dichiarazione incompleta" ng-src="assets/images/incompleta_rigth_red_aa0000.png">
        </a> -->
        <div class="container" style="position: relative;">
            <div class="row">
                <div id="scheda-basic" class="col-md-3">
                    <div class="portrait-picture">
                        <img ng-src="http://op_openparlamento_images.s3.amazonaws.com/big/{{scheda.op_id}}.jpg"
                             alt="{{scheda.nome|capitalize:all}} {{scheda.cognome|capitalize:all}}"/>
                    </div>
                    <div class="scheda-items">
                        <p>Data di nascita: <b>{{scheda.data_nascita | date:'dd-MM-yyyy'}}</b></p>

                        <p>Residenza: <b>{{scheda.comune_residenza|capitalize:all}}
                            ({{scheda.provincia_residenza|capitalize:team}})</b></p>

                        <p>Stato civile: <b>{{scheda.stato_civile}}</b></p>

                        <p>Professione: <b>{{scheda.professione}}</b></p>

                        <br/>

                        <h4>Incarichi</h4>

                        <div class="well" ng-repeat="incarico in scheda.incarichi">
                            <p>
                                Istituzione: <strong><a ng-href="#/istituzioni/{{incarico.istituzione}}">{{incarico.istituzione}}</a></strong>
                            </p>

                            <p>
                                Incarico: <strong>{{incarico.incarico}}</strong>
                            </p>

                            <p ng-show="incarico.gruppo.acronym">
                                Gruppo: <strong><a ng-href="#/gruppo/{{incarico.gruppo.acronym}}">{{incarico.gruppo.acronym|capitalize:'first'}} - {{incarico.gruppo.name}}</a></strong>
                            </p>

                            <p ng-show="incarico.istituzione == 'camera'">
                                Lista di elezione: <strong>{{incarico.partito.acronym|capitalize:'first'}} - {{incarico.partito.name}}</strong>
                            </p>
                            <p ng-show="incarico.istituzione == 'senato'">
                                Lista di elezione: <strong>{{incarico.partito.acronym|capitalize:'first'}} - {{incarico.partito.name}}</strong>
                            </p>
                            <p ng-show="incarico.istituzione == 'governo'">
                                Partito: <strong>{{incarico.partito.acronym|capitalize:'first'}} - {{incarico.partito.name}}</strong>
                            </p>

                            <p ng-show="incarico.circoscrizione">
                                Circoscrizione: <strong><a ng-href="#/circoscrizioni/{{incarico.circoscrizione}}">{{incarico.circoscrizione|capitalize:'first'}}</a></strong>
                            </p>
                        </div>
                    </div>
                    <a href="http://parlamento17.openpolis.it/parlamentare/{{scheda.op_id}}" class="highlight-link" target="_blank">VISUALIZZA LA SUA ATTIVITÀ PARLAMENTARE</a>
                    <br>
                    <div>
                        <p><a href="{{scheda.filename_url}}" target="_blank" class="highlight-link">SCARICA I DOCUMENTI ORIGINALI DELLE DICHIARAZIONI PATRIMONIALI</a></p>
                    </div>

                </div>
                <div class="col-md-9" style="position:relative">
                    <h3>Dichiarazioni patrimoniali</h3>
                    <ul class="nav nav-tabs" role="tablist">
                        <li ng-repeat="dichiarazione in schede"
                            ng-class="{'active': scheda.anno_dichiarazione === dichiarazione.anno_dichiarazione}"
                            ng-click="selectYear($index)" role="presentation">
                            <a href="" role="tab" data-toggle="tab">{{dichiarazione.anno_dichiarazione}}</a>
                        </li>
                    </ul>
                    <br>

                    <div class="well">
                        <div class="row">
                          <div class="col-md-2"><strong>Completezza della dichiarazione patrimoniale</strong>
                          </div>
                            <div class="col-md-3">
                                <div class="progress">
                                    <span class="progress-step progress-step-1_3"></span><span class="progress-step progress-step-2_3"></span>
                                    <div class="progress-bar" role="progressbar"
                                         aria-valuenow="{{133-(scheda.indice_completezza*33)}}" aria-valuemin="0"
                                         aria-valuemax="100" style="width: {{133-(scheda.indice_completezza*33)}}%;">
                                        <span class="sr-only">{{scheda.indice_completezza*33}}% Complete</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-7">
                              <p class="font-size-medium"><b>{{scheda.indice_completezza|completeness_mapping}} - {{scheda.note_completezza | format_note_completezza:'title' | capitalize:'first' }}</b><br/>
                                {{scheda.note_completezza | format_note_completezza:'body' | capitalize:'first'}}.</p>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-4">
                            <p><a href="" ng-click="scrollTo('modello-redditi')">Reddito: <b>{{scheda.totale_730_dichiarante|currency}}</b></a>
                            </p>
                        </div>
                        <div class="col-md-4">
                            <p><a href="" ng-click="scrollTo('partecipazioni-soc')">N. di partecipazioni (azioni/quote) in società: <b>{{scheda.partecipazioni_soc.length}}</b></a>
                            </p>
                        </div>
                        <div class="col-md-4">
                            <p ng-show="scheda.totale_spese_elettorali">
                              <a href="" ng-click="scrollTo('spese-elettorali')">Spese elettorali: <b>{{scheda.totale_spese_elettorali|currency:"€"}}</b></a>
                            </p>
                            <p ng-hide="scheda.totale_spese_elettorali">
                              <a ng-hide="getLastSpeseYear()=='Nessuna voce'" ng-click="selectAndScroll(lastSpeseYearIndex, 'spese-elettorali')" href="" >Spese elettorali: <b>{{getLastSpeseYear()}}</b></a>
                              <span ng-show="getLastSpeseYear()=='Nessuna voce'" class="no-contrib-expense">Spese elettorali: <b>{{getLastSpeseYear()}}</b></span>
                            </p>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-4">
                            <p><a href="" ng-click="scrollTo('lista-fabbricati')">N. fabbricati: <b>{{(scheda.beni_immobili| filter:{$:'fabbricato'}).length}}</b></a>
                            </p>
                            <p><a href="" ng-click="scrollTo('lista-terreni')">N. terreni: <b>{{(scheda.beni_immobili| filter:{$:'terreno'}).length}}</b></a>
                            </p>
                        </div>
                        <div class="col-md-4">
                            <p><a href="" ng-click="scrollTo('amministrazioni-soc')">N. di incarichi di amministratore di società: <b>{{scheda.amministrazioni_soc.length}}</b></a>
                            </p>
                        </div>
                        <div class="col-md-4"></div>
                    </div>

                    <div class="row">
                        <div class="col-md-4">
                            <p><a href="" ng-click="scrollTo('beni-mobili')">Numero beni mobili: <b>{{scheda.beni_mobili.length}}</b></a>
                            </p>
                        </div>
                        <div class="col-md-4">
                            <p ng-show="scheda.totale_contributi_elettorali">
                              <a href="" ng-click="scrollTo('contributi-elettorali')">Contributi elettorali: <b>{{scheda.totale_contributi_elettorali|currency:"€"}}</b></a>
                            </p>
                            <p ng-hide="scheda.totale_contributi_elettorali">
                              <a ng-hide="getLastContributiYear()=='Nessuna voce'" href="" ng-click="selectAndScroll(lastContributiYearIndex, 'contributi-elettorali')">Contributi elettorali: <b>{{getLastContributiYear()}}</b></a>
                              <span ng-show="getLastContributiYear()=='Nessuna voce'" ng-click="selectAndScroll(lastContributiYearIndex, 'contributi-elettorali')" class="no-contrib-expense" >Contributi elettorali: <b>{{getLastContributiYear()}}</b></span>
                            </p>
                        </div>
                        <div class="col-md-4"></div>
                    </div>

                    <hr/>

                    <!--
                    *
                    *    VOCI REDDITO
                    *
                    -->

                    <div id="modello-redditi">
                        <h3>Voci di reddito {{scheda.anno_dichiarazione}} <a href="" custom-popover popover-html="Testo di aiuto <b>bold?</b>" popover-placement="bottom" popover-label="?"></a></h3>
                    </div>
                    <table class="table table-striped">
                        <thead>
                        <tr>
                            <th>Voce</th>
                            <th>Dichiarante</th>
                            <th>Coniuge</th>
                            <th>Totali</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="voce in scheda.reddito_730">
                            <td ng-repeat="(k, v) in voce">
                                <div ng-if="isNumber(v)">{{v|currency:"€"|no_data}}</div>
                                <div ng-if="!isNumber(v)">{{v}}</div>
                            </td>
                        </tr>
                        </tbody>
                        <tfoot>
                        <tr>
                            <td><b>Totale dichiarato</b></td>
                            <td></td>
                            <td></td>
                            <td><b>{{scheda.totale_730|currency:"€"|no_data}}</b></td>
                        </tr>
                        </tfoot>
                    </table>

                    <!--
                    *
                    *    BENI IMMOBILI, the power of filter filter!
                    *
                    -->

                    <!-- FABBRICATI-->
                    <div ng-show="(scheda.beni_immobili| filter:{$:'fabbricato'}).length" id="lista-fabbricati">
                        <h3>Fabbricati {{scheda.anno_dichiarazione}}</h3>
                    </div>
                    <table ng-show="(scheda.beni_immobili| filter:{$:'fabbricato'}).length" class="table table-striped">
                        <thead>
                        <tr>
                            <th>Persona</th>
                            <th>Diritto</th>
                            <th>Provincia</th>
                            <th>Comune</th>
                            <th>Rendita catastale</th>
                            <th>Codice utilizzo</th>
                            <th>Categoria catastale</th>
                            <th>Quata possesso</th>
                            <th>Note</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="voce in scheda.beni_immobili| filter:{$:'fabbricato'}">
                            <td>
                                {{voce.persona|no_data}}
                            </td>
                            <td>
                                {{voce.natura_diritto|no_data}}
                            </td>
                            <td>
                                {{voce.provincia|no_data}}
                            </td>
                            <td>
                                {{voce.comune|no_data}}
                            </td>
                            <td>
                                {{voce.rendita_catastale|no_data}}
                            </td>
                            <td>
                                {{voce.codice_utilizzo|no_data}}
                            </td>
                            <td>
                                {{voce.categoria_catastale|no_data}}
                            </td>
                            <td ng-show="voce.natura_diritto == 'proprietà'">
                                100%
                            </td>
                            <td ng-show="voce.natura_diritto != 'proprietà'">
                                {{voce.quota_possesso|no_data}}
                            </td>
                            <td>
                                {{voce.annotazioni|no_data}}
                            </td>
                        </tr>
                        </tbody>
                    </table>

                    <div ng-show="(scheda.beni_immobili| filter:{$:'terreno'}).length" id="lista-terreni">
                        <h3>Terreni {{scheda.anno_dichiarazione}}</h3>
                    </div>
                    <table ng-show="(scheda.beni_immobili| filter:{$:'terreno'}).length" class="table table-striped">
                        <thead>
                        <tr>
                            <th>Persona</th>
                            <th>Diritto</th>
                            <th>Provincia</th>
                            <th>Comune</th>
                            <th>Reddito dominicale</th>
                            <th>Reddito agrario</th>
                            <th>Quota possesso</th>
                            <th>Note</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="voce in scheda.beni_immobili| filter:{$:'terreno'}">
                            <td>
                                {{voce.persona|no_data}}
                            </td>
                            <td>
                                {{voce.natura_diritto|no_data}}
                            </td>
                            <td>
                                {{voce.provincia|no_data}}
                            </td>
                            <td>
                                {{voce.comune|no_data}}
                            </td>
                            <td>
                                {{voce.reddito_dominicale|no_data}}
                            </td>
                            <td>
                                {{voce.reddito_agrario|no_data}}
                            </td>
                            <td ng-show="voce.natura_diritto == 'proprietà'">
                                100%
                            </td>
                            <td ng-show="voce.natura_diritto != 'proprietà'">
                                {{voce.quota_possesso|no_data}}
                            </td>
                            <td>
                                {{voce.annotazioni|no_data}}
                            </td>
                        </tr>
                        </tbody>
                    </table>

                    <!--
                    *
                    *    BENI MOBILI
                    *
                    -->

                    <div ng-show="scheda.beni_mobili.length" id="beni-mobili">
                        <h3>Beni mobili {{scheda.anno_dichiarazione}}</h3>
                    </div>
                    <table ng-show="scheda.beni_mobili.length" class="table table-striped">
                        <thead>
                        <tr>
                            <th>Persona</th>
                            <th>Tipologia</th>
                            <th>Cavalli fiscali</th>
                            <th>Modello</th>
                            <th>Marca</th>
                            <th>Anno immatr.</th>
                            <th>Annotazioni</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="voce in scheda.beni_mobili">
                            <td ng-repeat="(k, v) in voce">
                                {{v|no_data}}
                            </td>
                        </tr>
                        </tbody>
                    </table>

                    <!--
                    *
                    *    PARTECIPAZIONI SOCIETA'
                    *
                    -->

                    <div ng-show="scheda.partecipazioni_soc.length" id="partecipazioni-soc">
                        <h3>Partecipazioni in società {{scheda.anno_dichiarazione}}</h3>
                    </div>
                    <table ng-show="scheda.partecipazioni_soc.length" class="table table-striped">
                        <thead>
                        <tr>
                            <th>Città</th>
                            <th>Provincia</th>
                            <th>Persona</th>
                            <th>Denominazione</th>
                            <th>Attività prevalente</th>
                            <th>Numero quote</th>
                            <th>Valore economico</th>
                            <th>Annotazioni</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="voce in scheda.partecipazioni_soc">
                            <td ng-repeat="(k, v) in voce">
                              {{v|no_data}}
                            </td>
                        </tr>
                        </tbody>
                    </table>


                    <!--
                    *
                    *    AMMINISTRAZIONI SOCIETA'
                    *
                    -->

                    <div ng-show="scheda.amministrazioni_soc.length" id="amministrazioni-soc">
                        <h3>Amministrazioni di società {{scheda.anno_dichiarazione}}</h3>
                    </div>
                    <table ng-show="scheda.amministrazioni_soc.length" class="table table-striped">
                        <thead>
                        <tr>
                            <th>Città</th>
                            <th>Provincia</th>
                            <th>Persona</th>
                            <th>Denominazione</th>
                            <th>Attività prevalente</th>
                            <th>Natura incarico</th>
                            <th>Annotazioni</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="voce in scheda.amministrazioni_soc">
                            <td ng-repeat="(k, v) in voce">
                                {{v|no_data}}
                            </td>
                        </tr>
                        </tbody>
                    </table>

                    <!--
                    *
                    *    CONTRIBUTI ELETTORALI
                    *
                    -->

                    <div ng-show="scheda.totale_contributi_elettorali" id="contributi-elettorali">
                        <h3>Contributi elettorali {{scheda.anno_dichiarazione}}:
                            {{scheda.totale_contributi_elettorali|currency:"€"}}</h3>
                    </div>
                    <table ng-show="scheda.totale_contributi_elettorali" class="table table-striped">
                        <thead>
                        <tr>
                            <th>Tipo</th>
                            <th>Elezione</th>
                            <th>Importo</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="voce in scheda.contributi_elettorali">
                            <td>{{voce.fonte|no_data}}</td>
                            <td>{{voce.tipo_elezione|no_data}}</td>
                            <td>{{voce.importo|currency:"€"|no_data}}</td>
                        </tr>
                        </tbody>
                        <tfoot>
                        <tr>
                            <td><b>Totale dichiarato</b></td>
                            <td></td>
                            <td><b>{{scheda.totale_contributi_elettorali|currency:"€"}}</b></td>
                        </tr>
                        </tfoot>
                    </table>

                    <!--
                    *
                    *    SPESE ELETTORALI
                    *
                    -->

                    <div ng-show="scheda.totale_spese_elettorali" id="spese-elettorali">
                        <h3>Spese elettorali {{scheda.anno_dichiarazione}}:
                            {{scheda.totale_spese_elettorali|currency:"€"}}</h3>
                    </div>
                    <table ng-show="scheda.totale_spese_elettorali" class="table table-striped">
                        <thead>
                        <tr>
                            <th>Tipo</th>
                            <th>Elezione</th>
                            <th>Importo</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="voce in scheda.spese_elettorali">
                            <td>{{voce.fonte|no_data}}</td>
                            <td>{{voce.tipo_elezione|no_data}}</td>
                            <td>{{voce.importo|currency:"€"|no_data}}</td>
                        </tr>
                        </tbody>
                        <tfoot>
                        <tr>
                            <td><b>Totale dichiarato</b></td>
                            <td></td>
                            <td><b>{{scheda.totale_spese_elettorali|currency:"€"}}</b></td>
                        </tr>
                        </tfoot>
                    </table> <!-- spese_elettorali -->

                    <hr/>
                    <br/>

                </div>
            </div>

        </div>
    </div>
</div>
